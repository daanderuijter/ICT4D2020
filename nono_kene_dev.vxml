<?xml version="1.0" encoding="UTF-8"?>
<vxml version = "2.1" >

<var name="quantity"/>

<!-- Welcome message -->
<form id="welcomeMessage">
<block>
<prompt bargein="true">
	<audio src="/wavs/welcome_message.wav">
	<break time="1000"/>
</prompt>
<goto next="#MainMenu"/>
</block>
</form>

<!-- Menu for Selecting Buy or Sell using DTMF-->
<menu id="MainMenu" dtmf="true" scope="dialog">
   <prompt>if you want to buy Milk select 1, if you want to sell milk select 2</prompt>
   <choice event="buy" dtmf="1" message="Buy"></choice>
   <choice next="#sell" dtmf="2"></choice>
</menu>

<catch event="buy">
 <prompt>
  You have chosen to buy milk
  <break time="1000"/>
 </prompt>
<goto next="#EndMenu"/>
</catch> 

<catch event="correctSell_event">
<goto next="#correctSell"/>
</catch>

<menu id="sell" dtmf="true" scope="dialog">
   <prompt>You have chosen to sell milk. If this is incorrect select 1. Otherwise, select 2
   </prompt>
   <choice next="#MainMenu" dtmf="1"></choice>
   <choice event="correctSell_event" dtmf="2"></choice>
</menu>

<form id="correctSell">
	<!-- Quantity field-->
	<field name="form_quantity" type="number">
		<prompt> 
			enter the quantity and press hash
		</prompt>
	<!--"filled" event for quantity field-->
   	<filled>
	<!--save entered value in variable-->
 	<assign name="quantity" expr="form_quantity"/>
		</filled>
	</field>
	<!-- "filled" event for entire form-->
    <filled>
		<goto next="#sellConfirm"/> <!--go to EndMenu-->
	</filled>
</form>

<menu id="sellConfirm" dtmf="true" scope="dialog">
	<prompt>
		The quantity of milk you have selected to sell is
		<value expr="quantity"/>
		<break time="500"/>
		If this is incorrect select 1. Otherwise, select 2
	</prompt>
   <choice next="#correctSell" dtmf="1"></choice>
   <choice next="#EndMenu" dtmf="2"></choice>
</menu> 

<menu id="EndMenu" dtmf="true" scope="dialog">
   <prompt>if you want to cut the connection select 1, if you want to go back to the start of the service select 2</prompt>
   <choice event="end" dtmf="1"></choice>
   <choice next="#MainMenu" dtmf="2"></choice>
</menu>

<!-- end event. close call-->
<catch event="end"> 
   <prompt>Goodbye!</prompt>
   <disconnect/> 
</catch>
</vxml>
